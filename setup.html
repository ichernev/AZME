<!DOCTYPE html><!-- G5Framework -->

<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->

<head>
<meta charset="UTF-8"> 

<title>Alpha Zemerge (Micro-Economy)</title>

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="imagetoolbar" content="no" />

<link rel="stylesheet" media="screen" href="css/base.css?v=2" /> <!--Load CSS-->
<link rel="stylesheet" media="handheld" href="css/handheld.css?v=2" /> <!-- Mobile -->

<link media="all" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/base/jquery-ui.css" rel="stylesheet">

<script src="js/libs/modernizr-1.6.min.js"></script> <!-- Modernizr -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script><!--Load jQuery-->
<script>!window.jQuery && document.write(unescape('%3Cscript src="js/libs/jquery-1.5.2.min.js"%3E%3C/script%3E'))</script>
<script src="js/script.js"></script>
<script src="js/jquery.tipsy.js"></script>
<script src="js/jquery.reveal.js"></script>
<script src="js/jquery.orbit.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>

<script src="js/modals.js"></script>

<script>
   $(window).load(function() {

		$(function() {
			$( "#housesSlider" ).slider({
			value:100,
			min: 10,
			max: 200,
			step: 10,
			slide: function( event, ui ) {
				$( "#numHouseholds" ).val( ui.value );
			}
		});
			$( "#numHouseholds" ).val( $( "#housesSlider" ).slider( "value" ) );
		});

		$(function() {
			$( "#maxGovWorkersSlider" ).slider({
			value:10,
			min: 0,
			max: 100,
			step: 5,
			slide: function( event, ui ) {
				$( "#maxGovWorkers" ).val( ui.value );
			}
		});
			$( "#maxGovWorkers" ).val( $( "#maxGovWorkersSlider" ).slider( "value" ) );
		});

		$(function() {
			$( "#maxBusinessesSlider" ).slider({
			value:20,
			min: 0,
			max: 100,
			step: 5,
			slide: function( event, ui ) {
				$( "#maxBusinesses" ).val( ui.value );
			}
		});
			$( "#maxBusinesses" ).val( $( "#maxBusinessesSlider" ).slider( "value" ) );
		});

		$(function() {
			$( "#salestaxSlider" ).slider({
			value:10,
			min: 0,
			max: 50,
			step: 1,
			slide: function( event, ui ) {
				$( "#salestax" ).val( ui.value );
			}
		});
			$( "#salestax" ).val( $( "#salestaxSlider" ).slider( "value" ) );
		});

		$(function() {
			$( "#incometaxSlider" ).slider({
			value:10,
			min: 0,
			max: 50,
			step: 1,
			slide: function( event, ui ) {
				$( "#incometax" ).val( ui.value );
			}
		});
			$( "#incometax" ).val( $( "#incometaxSlider" ).slider( "value" ) );
		});

		$(function() {
			$( "#minwagepaySlider" ).slider({
			value:100,
			min: 0,
			max: 500,
			step: 10,
			slide: function( event, ui ) {
				$( "#minwagepay" ).val( ui.value );
			}
		});
			$( "#minwagepay" ).val( $( "#minwagepaySlider" ).slider( "value" ) );
		});

		$(function() {
			$( "#bankreservereqSlider" ).slider({
			value:9,
			min: 1,
			max: 25,
			step: 1,
			slide: function( event, ui ) {
				$( "#bankreservereq" ).val( ui.value );
			}
		});
			$( "#bankreservereq" ).val( $( "#bankreservereqSlider" ).slider( "value" ) );
		});

		$(function() {
			$( "#bankdepositrateSlider" ).slider({
			value:1,
			min: 0,
			max: 10,
			step: 0.5,
			slide: function( event, ui ) {
				$( "#bankdepositrate" ).val( ui.value );
			}
		});
			$( "#bankdepositrate" ).val( $( "#bankdepositrateSlider" ).slider( "value" ) );
		});

		$(function() {
			$( "#bankloanrateSlider" ).slider({
			value:3,
			min: 0,
			max: 20,
			step: 0.5,
			slide: function( event, ui ) {
				$( "#bankloanrate" ).val( ui.value );
			}
		});
			$( "#bankloanrate" ).val( $( "#bankloanrateSlider" ).slider( "value" ) );
		});

		$(function() {
			$( "#householdspendingfactorSlider" ).slider({
			value:10,
			min: 1,
			max: 100,
			step: 1,
			slide: function( event, ui ) {
				$( "#householdspendingfactor" ).val( ui.value );
			}
		});
			$( "#householdspendingfactor" ).val( $( "#householdspendingfactorSlider" ).slider( "value" ) );
		});

     });
     
	function getDistribution(min,max,avg) {
	    var p = (avg-min)/(max-min);
	    var x = 0;
	    for(var i = 0; i < (max-min); i++) {
	        if(Math.random() < p)
	        x++;
	    }
	    return x + min;
	}     
 
	function saveInitialSimParameters() {
		
		// Clear local storage
		localStorage.clear();
		
		localStorage["az.simday"] = '0';  // Backend counts from 0.
		
		var numHouseholds = parseInt($('#numHouseholds').val());
		var startingHouseholdAssets = parseInt($('#startingHouseholdAssets').val());

		localStorage["az.maxGovWorkers"] = parseInt($('#maxGovWorkers').val());
		localStorage["az.maxBusinesses"] = parseInt($('#maxBusinesses').val());
		localStorage["az.salestax"] = parseInt($('#salestax').val());
		localStorage["az.incometax"] = parseInt($('#incometax').val());
		localStorage["az.minwagepay"] = parseInt($('#minwagepay').val());
		localStorage["az.bankreservereq"] = parseInt($('#bankreservereq').val());
		localStorage["az.bankdepositrate"] = parseFloat($('#bankdepositrate').val());
		localStorage["az.bankloanrate"] = parseFloat($('#bankloanrate').val());
		localStorage["az.householdspendingfactor"] = parseFloat($('#householdspendingfactor').val());
		
		localStorage["az.householdCount"] = numHouseholds;
		for (var i = 1; i <= numHouseholds; i++) {
			localStorage["az.household." + i + ".netassets"] = startingHouseholdAssets;
			localStorage["az.household." + i + ".cash"] = startingHouseholdAssets;
			//localStorage["az.household." + i + ".netassets"] = Math.round(100000 * Math.random()*2);
			//localStorage["az.household." + i + ".netassets"] = 1000*i;
			localStorage["az.household." + i + ".income"] = 0;
			//localStorage["az.household." + i + ".income"] = Math.round(50000 * Math.random());
			/*localStorage["az.household." + i + ".netassetsHistory.week"] = Math.round(100000*(1+Math.random()-Math.random()));
			localStorage["az.household." + i + ".netassetsHistory.month"] = Math.round(100000*(1+Math.random()-Math.random()));
			localStorage["az.household." + i + ".netassetsHistory.year"] = Math.round(100000*(1+Math.random()-Math.random()));*/
			localStorage["az.household." + i + ".netassetsHistory.week"] = startingHouseholdAssets;
			localStorage["az.household." + i + ".netassetsHistory.month"] = startingHouseholdAssets;
			localStorage["az.household." + i + ".netassetsHistory.year"] = startingHouseholdAssets;
			localStorage["az.household." + i + ".numpeople"] = Math.round(getDistribution(1,10,2.5));
		}
		var numBusiness = 0;
		localStorage["az.businessCount"] = numBusiness;
		
		localStorage["az.bank.netassets"] = 0;
		//localStorage["az.bank.depositsBank"] = 0;
		localStorage["az.bank.curloansBank"] = 0;
		//localStorage["az.bank.avaloansBank"] = 0;
		localStorage["az.bank.netassetsHistory.week"] = 0;
		localStorage["az.bank.netassetsHistory.month"] = 0;
		localStorage["az.bank.netassetsHistory.year"] = 0;
		
		for (var i = 1; i <= numHouseholds; i++)
		{
			localStorage["az.bank.depositsBank.household." + i] = 0;
		}
		
		localStorage["az.gov.netassets"] = 0;
		localStorage["az.gov.cash"] = 0;
		localStorage["az.gov.numemp"] = 0;
		localStorage["az.gov.taxcollected"] = 0;
		localStorage["az.gov.netassetsHistory.week"] = 0;
		localStorage["az.gov.netassetsHistory.month"] = 0;
		localStorage["az.gov.netassetsHistory.year"] = 0;

		//localStorage["az.resources"] = numHouseholds * 1000; // 1000 units of resources per household, regeneration rate of 1 resource a day per household
		
		window.location = "run.html";
	}
 
	function checkLocalStorage()
	{    
		if (Modernizr.localstorage) {
			return true;
		} else {
			alert('This Web Application Requires an HTML5 friendly browser (IE8+, Firefox 3.5+, Safari 4.0+, Chrome 4.0+, Opera 10.5+)');
			return false;
		}     
	}     
</script>

</head>
<body>
	
    <div id="wrapper">
        
        <section class="content" style="padding-bottom:0px">

            <section class="cols vis-break brdr cntrtxt">
		
				<h3 class="topspc btmspc">Enter Simulation Parameters:</h3>	
					
				<p>
					<label for="numHouseholds" class="tooltip" title="The number of households in the simulation, increasing this number will slow the simulation.">Number of Households:</label>
					<input class="inputparam" type="text" id="numHouseholds" />
				</p>
				<center> 
					<div id="housesSlider" style="width:300px;"></div>
				</center>
				<br/>
				<p>
					<label for="startingHouseholdAssets" class="tooltip" title="The starting amount of assets each household owns.">Starting Household Assets: </label>
					<input class="inputparam" type="text" id="startingHouseholdAssets" value="100000" />
				</p>
				<br/>
				<p>
					<label for="maxGovWorkers" class="tooltip" title="The maximum amount of households that can work for the government.">Maximum % of government workers: </label>
					<input class="inputparam" type="text" id="maxGovWorkers" value="10" />
				</p>
				<center> 
					<div id="maxGovWorkersSlider" style="width:300px;"></div>
				</center>
				<br/>
				<p>
					<label for="maxBusinesses" class="tooltip" title="The maximum amount of businesses as percentage to households.">Maximum number of businesses (% of households): </label>
					<input class="inputparam" type="text" id="maxBusinesses" value="20" />
				</p>
				<center> 
					<div id="maxBusinessesSlider" style="width:300px;"></div>
				</center>
				<br/>
				<p>
					<label for="salestax" class="tooltip" title="Sales tax applied to all purchases between different identities.">Sales Tax (%): </label>
					<input class="inputparam" type="text" id="salestax" value="10" />
				</p>
				<center> 
					<div id="salestaxSlider" style="width:300px;"></div>
				</center>
				<br/>
				<p>
					<label for="incometax" class="tooltip" title="Income tax applied to all income transferred to the households.">Income Tax (%): </label>
					<input class="inputparam" type="text" id="incometax" value="10" />
				</p>
				<center> 
					<div id="incometaxSlider" style="width:300px;"></div>
				</center>
				<br/>
				<p>
					<label for="minwagepay" class="tooltip" title="The minimum employment pay - or the standard flat employment rate for now for each employee per day.">Minimum Employment Pay (per day): </label>
					<input class="inputparam" type="text" id="minwagepay" value="100" />
				</p>
				<center> 
					<div id="minwagepaySlider" style="width:300px;"></div>
				</center>
				<br/>
				<p>
					<label for="minwagepay" class="tooltip" title="The bank reserve requirement ratio specifies how much the bank can loan out as a fraction of the deposits.">Bank Reserve Requirement Ratio - Loan:Reserve (X:1): </label>
					<input class="inputparam" type="text" id="bankreservereq" value="9" />
				</p>
				<center> 
					<div id="bankreservereqSlider" style="width:300px;"></div>
				</center>
				<br/>
				<p>
					<label for="bankdepositrate" class="tooltip" title="The bank payed out interest to all deposits.">Bank Deposit Interest Rate (%): </label>
					<input class="inputparam" type="text" id="bankdepositrate" value="1" />
				</p>
				<center> 
					<div id="bankdepositrateSlider" style="width:300px;"></div>
				</center>
				<br/>
				<p>
					<label for="bankloanrate" class="tooltip" title="The bank charging interest rate for loans.">Bank Loan Interest Rate (%): </label>
					<input class="inputparam" type="text" id="bankloanrate" value="3" />
				</p>
				<center> 
					<div id="bankloanrateSlider" style="width:300px;"></div>
				</center>
				<br/>
				<p>
					<label for="householdspendingfactor" class="tooltip" title="Setting this at 10% means that a household can spend somewhere between $0 and 10% of the current cash on hand.">Max household spending per day for current cash on hand (%): </label>
					<input class="inputparam" type="text" id="householdspendingfactor" value="10" />
				</p>
				<center> 
					<div id="householdspendingfactorSlider" style="width:300px;"></div>
				</center>
				
				<!--<a class="button red" href="#" onclick="if(checkLocalStorage()==true){document.forms['parametersform'].submit();}" style="margin-top:20px;">Run Simulation</a>-->
				<a class="button red" href="#" onclick="if(checkLocalStorage()==true){saveInitialSimParameters();}" style="margin-top:20px;">Run Simulation</a>			

			</section>

		</section>

	</div>

	<!--[if lt IE 7 ]>
	<script src="js/libs/dd_belatedpng.js"></script>
	<script> DD_belatedPNG.fix('img, .png_bg');</script>
	<![endif]-->
	
	<!--[if IE 6]>
	    <script type="text/javascript"> 
	        /*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	            var IE6UPDATE_OPTIONS = {
	                icons_path: "js/ie6update/images/"
	            }
	     </script>
	     <script type="text/javascript" src="js/ie6update/ie6update.js"></script>
	<![endif]-->

</body>
</html>
